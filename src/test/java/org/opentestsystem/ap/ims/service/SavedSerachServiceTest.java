package org.opentestsystem.ap.ims.service;

import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.runners.MockitoJUnitRunner;
import org.opentestsystem.ap.common.datastore.repository.SavedSearchRepository;
import org.springframework.boot.test.mock.mockito.MockBean;

import static org.assertj.core.api.Assertions.assertThat;

@RunWith(MockitoJUnitRunner.class)
public class SavedSerachServiceTest {

    @MockBean
    private SavedSearchRepository mockSavedSearchRepository;

    private SavedSearchService service;

    @Before
    public void setUp() {
        service = new SavedSearchService(mockSavedSearchRepository);
    }

    @Test
    public void itShouldParseCommaSeparatedString() {
        final String one = "1@email.com";
        final String two = "2@email.com";
        final String three = "3@email.com";
        final String four = "4@email.com";

        final String both = one + ", " + two;
        final String all = "  , " + both + "    ,    " + three + " ,  " + four + ",   ";

        assertThat(service.parseValues(null)).hasSize(0);
        assertThat(service.parseValues(one)).hasSize(1);
        assertThat(service.parseValues(both)).hasSize(2);
        assertThat(service.parseValues(both)).contains(one, two);
        assertThat(service.parseValues(all)).hasSize(4);
        assertThat(service.parseValues(all)).contains(one, two, three, four);
    }
}
